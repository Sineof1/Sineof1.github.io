<html lang='en'>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>LiveHint QR</title>
</head>

<body>
<script SameSite="None; Secure" src="https://static.landbot.io/landbot-3/landbot-3.0.0.js"></script>
<script>
var landbotChoice = null;
const queryString = window.location.search;
const urlParams = new URLSearchParams(queryString);

const course = urlParams.get('qr_course');
const module = urlParams.get('qr_module');
const pagenm = urlParams.get('qr_page');
const ch1 = urlParams.get('customhint1');
const ch2 = urlParams.get('customhint2');
const ch3 = urlParams.get('customhint3');
var userUniqueID, setCourse, setModule;

userUniqueID = localStorage.getItem('userUniqueID');
setCourse = localStorage.getItem('userCourse');
setModule = localStorage.getItem('userModule');
   
if (userUniqueID === null) {
   userUniqueID = create_UUID();
   localStorage.setItem('userUniqueID', userUniqueID);
}
if (course && module && pagenm) {
   landbotChoice = new LandbotFullpage({index: `https://chats.landbot.io/v2/H-735420-KQUNO6NA262KFM4E/index.html?qr_course=${course}&qr_module=${module}&qr_page=${pagenm}&uniqueid=${userUniqueID}`,});
}
else {
   landbotChoice = new LandbotFullpage({index: `https://chats.landbot.io/v3/H-738372-KK0889SBPWEDRICO/index.html?uniqueid=${userUniqueID}`,});
}
function setTheCourse(crs) {localStorage.setItem('userCourse', crs);}
function setTheModule(mod) {localStorage.setItem('userModule', mod);}
function create_UUID(){
    var dt = new Date().getTime();
    var uuid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
       var r = (dt + Math.random()*16)%16 | 0;
       dt = Math.floor(dt/16);
       return (c=='x' ? r :(r&0x3|0x8)).toString(16);
    });
    return uuid;
}

var myLandbot = landbotChoice;
myLandbot.on('setCourse', function(data1){setTheCourse(data1);});
myLandbot.on('setModule', function(data2){setTheModule(data2);});
</script>
</body>

</html>
