<!DOCTYPE html>
<html>
<head>
    <title>Career Connections Prototype</title>
    <style>
        html {
            font-family:sans-serif;
        }
        body {
          position:relative;
          height: 100vh;
          margin-bottom:150px;
          padding: 0;
        }
        #animatedContainer {
          position:fixed;
          bottom:0;
          left:25%;
          width: 52%;
          height: 0;
          background-color: rgba(128, 188, 148, 1);
          padding: 20px;
          box-sizing: border-box;
          transition: height 1s ease-in-out;
          overflow: auto;
          border-radius:5px;
          color:white;
          font-family:sans-serif;
        }
        #hideButton {cursor:pointer;}
        table {
            width: 100%;
            table-layout: fixed;
            border: 1px solid #aaa;
            border-collapse:collapse;
        }
        .header, .colheader {
            font-weight:900;
        }
        .colheader {
            text-align:center;
        }
        th, td {
            padding: 15px;
            text-align: left;
            border: 1px solid #ddd;
        }
        .center {
            text-align:center;
        }
        .seqinput, .typeinput {
            width:20%;
            height:2.4em;
            outline:none;
            text-align:center;
            font-size:1em;
        }
        .typeinput {
            width:80%;
        }
        .intheadrow {
            background-color: #e4f3f2;
        }
        textarea {
            outline:none;
            box-sizing:border-box;
            padding:10px;
            resize:none;
            width:90%;
            font-size:1.3em;
        }
    </style>
<script src="https://d3js.org/d3.v5.min.js"></script>
<script defer src="https://cdn.jsdelivr.net/npm/mathlive@0.94.5/dist/mathlive.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>
<body>
    <table border="1">
        <thead>
            <tr>
                <th></th>
                <th class='colheader'>Chris's Tree</th>
                <th class='colheader'>Dexter's Tree</th>
                <th class='colheader'>Explanation</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td class='header'>Sequence</td>
                <td class='center'><input class='seqinput' id='chrisseq1' type='text' />, <input class='seqinput' id='chrisseq2' type='text' />, <input class='seqinput' id='chrisseq3' type='text' /></td>
                <td class='center'><input class='seqinput' id='dexseq1' type='text' />, <input class='seqinput' id='dexseq2' type='text' />, <input class='seqinput' id='dexseq3' type='text' /></td>
                <td class='center' rowspan="6"><textarea rows='40'></textarea></td>
            </tr>
            <tr>
                <td class='header'>Type of Sequence</td>
                <td class='center'><input class='typeinput' id='chris_type_sequence' type='text' /></td>
                <td class='center'><input class='typeinput' id='dexter_type_sequence' type='text' /></td>
            </tr>
            <tr>
                <td class='header'>Table</td>
                <td class='center'>
                <table class='inttable'>
                    <thead>
                        <tr>
                            <th class='intheadrow center'><input class='typeinput' id='chris_header_x' type='text' /></th>
                            <th class='intheadrow center'><input class='typeinput' id='chris_header_y' type='text' /></th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class='center'><input class='typeinput' id='x1_1' type='text' /></td>
                            <td class='center'><input class='typeinput' id='y1_1' type='text' /></td>
                        </tr>
                        <tr>
                            <td class='center'><input class='typeinput' id='x2_1' type='text' /></td>
                            <td class='center'><input class='typeinput' id='y2_1' type='text' /></td>
                        </tr>
                        <tr>
                            <td class='center'><input class='typeinput' id='x3_1' type='text' /></td>
                            <td class='center'><input class='typeinput' id='y3_1' type='text' /></td>
                        </tr>
                    </tbody>
                </table>
                </td>
                <td class='center'>
                <table>
                    <thead>
                        <tr>
                            <th class='intheadrow center'><input class='typeinput' id='dexter_header_x' type='text' /></th>
                            <th class='intheadrow center'><input class='typeinput' id='dexter_header_y' type='text' /></th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class='center'><input class='typeinput' id='x1_2' type='text' /></td>
                            <td class='center'><input class='typeinput' id='y1_2' type='text' /></td>
                        </tr>
                        <tr>
                            <td class='center'><input class='typeinput' id='x2_2' type='text' /></td>
                            <td class='center'><input class='typeinput' id='y2_2' type='text' /></td>
                        </tr>
                        <tr>
                            <td class='center'><input class='typeinput' id='x3_2' type='text' /></td>
                            <td class='center'><input class='typeinput' id='y3_2' type='text' /></td>
                        </tr>
                    </tbody>
                </table>
                </td>
            </tr>
            <tr>
                <td class='header'>Graph</td>
                <td class='center graph1'></td>
                <td class='center graph2'></td>
            </tr>
            <tr>
                <td class='header'>Recursive Formula</td>
                <td class='center'><math-field></math-field></td>
                <td class='center'><math-field></math-field></td>
            </tr>
            <tr>
                <td class='header'>Explicit Formula</td>
                <td class='center'><math-field></math-field></td>
                <td class='center'><math-field></math-field></td>
            </tr>
        </tbody>
    </table>
<div id="animatedContainer">
  <button id="hideButton" style="position: absolute; right: 10px; top: 10px;">&#x2195;</button>
  <h1>Career: Researcher</h1>
  <p style='font-weight:900;'>Analyze the growth pattern of each tree as described by Chris and Dexter.</p>
  <p>Chris and Dexter are researchers studying the impact of a genetic mutation on tree growth for different trees. They are tasked with monitoring the growth patterns of new trees. They agree to record their findings once a week for three weeks. At the end of three weeks, they meet and share their findings.</p>
  <p>Chris’s findings: The tree had grown 3 cm by the end of the first week and continued to grow 1 cm each week that followed.</p>
  <img src="https://guzintamath.com/images/chris_image.png" style='width:75%;display:block;margin:0 auto;' alt="Chris's findings">
  <p>Dexter’s findings: The tree had 3 branches at the end of the first week. For every passing week, each branch end separated into 3 more branches.</p>
  <img src="https://guzintamath.com/images/dexter_image.png" style='width:75%;display:block;margin:0 auto;' alt="Dexter's findings">
  <p><button name="name" value="value" type="submit" onclick="OpenaiFetchAPI()">How did I do?</button></p>
  <p id='gpt-results'></p>
</div>
</body>

<script>
$(document).ready(function() {
  var isContainerVisible = false;
  function toggleContainer() {
    isContainerVisible = !isContainerVisible;
    $('#animatedContainer').css('height', isContainerVisible ? '50vh' : '0');
  }
  $('#hideButton').click(toggleContainer);
  toggleContainer();
});
// Set the margins for graph1
var margin = {top: 30, right: 20, bottom: 30, left: 50};

// Add the SVG element
var svg = d3.select(".graph1")
    .append("svg")
    .style("width", "100%")
    .style("height", "100%")
    .style('background', 'transparent')
    .append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

// Calculate the width and height of the SVG
var svgNode = svg.node().parentNode;
var width = svgNode.getBoundingClientRect().width - margin.left - margin.right;
var height = svgNode.getBoundingClientRect().height - margin.top - margin.bottom;

// Set the ranges
var x = d3.scaleLinear().domain([0, 10]).range([0, width]);
var y = d3.scaleLinear().domain([0, 10]).range([height, 0]);

// Define the axes
var xAxis = d3.axisBottom(x).ticks(10).tickValues(d3.range(0, 11, 2));
var yAxis = d3.axisLeft(y).ticks(10).tickValues(d3.range(0, 11, 5));

// Add the X Axis
svg.append("g")
    .attr("transform", "translate(0," + height + ")")
    .call(xAxis);

// Add the Y Axis
svg.append("g")
    .call(yAxis);

// Set the margins for graph2
var margin2 = {top: 30, right: 20, bottom: 30, left: 50};

// Add the SVG element for graph2
var svg2 = d3.select(".graph2")
    .append("svg")
    .style("width", "100%")
    .style("height", "100%")
    .style('background', 'transparent')
    .append("g")
    .attr("transform", "translate(" + margin2.left + "," + margin2.top + ")");

// Calculate the width and height of the SVG for graph2
var svgNode2 = svg2.node().parentNode;
var width2 = svgNode2.getBoundingClientRect().width - margin2.left - margin2.right;
var height2 = svgNode2.getBoundingClientRect().height - margin2.top - margin2.bottom;

// Set the ranges for graph2
var x2 = d3.scaleLinear().domain([0, 10]).range([0, width2]);
var y2 = d3.scaleLinear().domain([0, 100]).range([height2, 0]); // Change domain to [0,100] for y-axis.

// Define the axes for graph2
var xAxis2 = d3.axisBottom(x2).ticks(10).tickValues(d3.range(0, 11, 5));
var yAxis2 = d3.axisLeft(y2).ticks(10).tickValues(d3.range(0, 101, 50)); // Label at every 50 units.

// Add the X Axis for graph2
svg2.append("g")
    .attr("transform", "translate(0," + height2 + ")")
    .call(xAxis2);

// Add the Y Axis for graph2
svg2.append("g")
    .call(yAxis2);

// Function to plot a point on Graph 1
d3.select("#x1_1").on("keyup", plotPointGraph1);
d3.select("#y1_1").on("keyup", plotPointGraph1);
d3.select("#x2_1").on("keyup", plotPointGraph1);
d3.select("#y2_1").on("keyup", plotPointGraph1);
d3.select("#x3_1").on("keyup", plotPointGraph1);
d3.select("#y3_1").on("keyup", plotPointGraph1);

function plotPointGraph1() {
    svg.selectAll("circle").remove();  // Remove existing point
    var xValue1 = +d3.select("#x1_1").property("value");
    var yValue1 = +d3.select("#y1_1").property("value");

    if (xValue1 && yValue1) {
    svg.append("circle")
        .attr("cx", x(xValue1))
        .attr("cy", y(yValue1))
        .attr("r", 5)
        .style("fill", "red");
    }

    var xValue2 = +d3.select("#x2_1").property("value");
    var yValue2 = +d3.select("#y2_1").property("value");

    if (xValue2 && yValue2) {
    svg.append("circle")
        .attr("cx", x(xValue2))
        .attr("cy", y(yValue2))
        .attr("r", 5)
        .style("fill", "red");
    }

    var xValue3 = +d3.select("#x3_1").property("value");
    var yValue3 = +d3.select("#y3_1").property("value");

    if (xValue3 && yValue3) {
    svg.append("circle")
        .attr("cx", x(xValue3))
        .attr("cy", y(yValue3))
        .attr("r", 5)
        .style("fill", "red");
    }
}

// Function to plot a point on Graph 2
d3.select("#x1_2").on("keyup", plotPointGraph2);
d3.select("#y1_2").on("keyup", plotPointGraph2);
d3.select("#x2_2").on("keyup", plotPointGraph2);
d3.select("#y2_2").on("keyup", plotPointGraph2);
d3.select("#x3_2").on("keyup", plotPointGraph2);
d3.select("#y3_2").on("keyup", plotPointGraph2);

function plotPointGraph2() {
    svg2.selectAll("circle").remove();  // Remove existing point
    var xValue1 = +d3.select("#x1_2").property("value");
    var yValue1 = +d3.select("#y1_2").property("value");

    if (xValue1 && yValue1) {
    svg2.append("circle")
        .attr("cx", x2(xValue1))
        .attr("cy", y2(yValue1))
        .attr("r", 5)
        .style("fill", "blue");
    }

    var xValue2 = +d3.select("#x2_2").property("value");
    var yValue2 = +d3.select("#y2_2").property("value");

    if (xValue2 && yValue2) {
    svg2.append("circle")
        .attr("cx", x2(xValue2))
        .attr("cy", y2(yValue2))
        .attr("r", 5)
        .style("fill", "blue");
    }

    var xValue3 = +d3.select("#x3_2").property("value");
    var yValue3 = +d3.select("#y3_2").property("value");

    if (xValue3 && yValue3) {
    svg2.append("circle")
        .attr("cx", x2(xValue3))
        .attr("cy", y2(yValue3))
        .attr("r", 5)
        .style("fill", "blue");
    }
}
function OpenaiFetchAPI() {
    console.log("Calling GPT4")
    var chris_sequence = $('#chrisseq1').val() + ', ' + $('#chrisseq2').val() + ', ' + $('#chrisseq3').val();
    var dexter_sequence = $('#dexseq1').val() + ', ' + $('#dexseq2').val() + ', ' + $('#dexseq3').val();
    console.log(chris_sequence, dexter_sequence);

    var chris_type_sequence = $('#chris_type_sequence').val();
    var dexter_type_sequence = $('#dexter_type_sequence').val();
    console.log(chris_type_sequence, dexter_type_sequence);

    var chris_ordered_pairs = '(' + $('#x1_1').val() + ', ' + $('#y1_1').val() + '), ' + '(' + $('#x2_1').val() + ', ' + $('#y2_1').val() + '), ' + '(' + $('#x3_1').val() + ', ' + $('#y3_1').val() + ')';
    var dexter_ordered_pairs = '(' + $('#x1_2').val() + ', ' + $('#y1_2').val() + '), ' + '(' + $('#x2_2').val() + ', ' + $('#y2_2').val() + '), ' + '(' + $('#x3_2').val() + ', ' + $('#y3_2').val() + ')';

    console.log(chris_ordered_pairs);

    var url = "https://api.openai.com/v1/chat/completions";
    var bearer = 'Bearer ' + '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';
    fetch(url, {
        method: 'POST',
        headers: {
            'Authorization': bearer,
            'Content-Type': 'application/json'
        },
        body: JSON.stringify({
            "model": "gpt-4",
            "temperature": 0.4,
            "messages": [{"role": "system", "content": "Your role is to just say hi."},{"role": "user", "content": ""}]
        })
    }).then(response => {
        return response.json()
    }).then(data=>{
        console.log(data)
        console.log(typeof data)
        console.log(Object.keys(data))
        console.log(data['choices'][0].message.content)
    })
        .catch(error => {
            console.log('Something bad happened ' + error)
        });
}
</script>
</html>
