<!DOCTYPE html>
<html lang='en'>
<head>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<style>

#canvas {
   background:rgb(51, 51, 51);
   display:block;
   margin-left:auto;
   margin-right:auto;
   margin-top:50px;
   width:500px;
   height:400px;
   box-shadow:0px 0px 30px #cccccc;
   border-radius:15px;
}
#canvas:hover {
   cursor:pointer;
}
button {
   outline: 0 none;
   box-shadow: 1px 1px 1px #cccccc;
   border:0px;
   background:#ffffff;
   font-size:1em;
   font-family: 'Josefin Sans', sans-serif;
   border-radius:5px;
   display: inline-block;
   font-variant:small-caps;
   padding: 8px 15px;
   text-decoration: none;
   font-weight: bold;
   color: #069;
   margin-left:10px;
}

button:hover {
   background-color:#f5f5f5;
   cursor:pointer;
}
#button-menu {
   width:350px;
   margin-top:20px;
   margin-left:auto;
   margin-right:auto;
}
</style>
</head>
<body>
<canvas id='canvas' width='500px' height='400px'>Canvas not supported.</canvas>
<div id='button-menu'>
<span style='margin-right:15px;font-size:22px;vertical-align:-5px;'>Discs</span>
<button value='1' onclick='setDiskNum(1)'>1</button>
<button value='2' onclick='setDiskNum(2)'>2</button>
<button value='3' onclick='setDiskNum(3)'>3</button>
<button value='4' onclick='setDiskNum(4)'>4</button>
<button value='5' onclick='setDiskNum(5)'>5</button>
</div>
</body>
</html>

<script>
//The canvas, context, and mouse/touch event locator.
var canvas = document.getElementById('canvas');
var context = canvas.getContext('2d');

function windowToCanvas_mouse(canvas, x, y) {
var bbox = canvas.getBoundingClientRect();
return {x: (x - bbox.left) * (canvas.width / bbox.width), y: (y - bbox.top) * (canvas.height / bbox.height)};}

//Globals
var CURRENTDISCNUM = 1;
var CURRENTSTARTPEG;
var CURRENTTARGETPEG;
var STARTSELECTED = false;
var TARGETSELECTED = false;

var DISC1 = {x: canvas.width / 4 - 50, y: canvas.height - 10, width: 100, height: 10,
	    draw: function() {context.fillStyle = 'blue'; context.beginPath(); context.rect(this.x, this.y, this.width, this.height); context.fill();}};
var DISC2 = {x: canvas.width / 4 - 40, y: canvas.height - 20, width: 80, height: 10,
	    draw: function() {context.fillStyle = 'red'; context.beginPath(); context.rect(this.x, this.y, this.width, this.height); context.fill();}};
var DISC3 = {x: canvas.width / 4 - 30, y: canvas.height - 30, width: 60, height: 10,
	    draw: function() {context.fillStyle = 'green'; context.beginPath(); context.rect(this.x, this.y, this.width, this.height); context.fill();}};
var DISC4 = {x: canvas.width / 4 - 20, y: canvas.height - 40, width: 40, height: 10,
	    draw: function() {context.fillStyle = 'yellow'; context.beginPath(); context.rect(this.x, this.y, this.width, this.height); context.fill();}};
var DISC5 = {x: canvas.width / 4 - 10, y: canvas.height - 50, width: 20, height: 10,
	    draw: function() {context.fillStyle = 'white'; context.beginPath(); context.rect(this.x, this.y, this.width, this.height); context.fill();}};
var DISCLIST = [DISC1, DISC2, DISC3, DISC4, DISC5];

//Baseline canvas at start and on redraws.
function baseDraw() {
   context.clearRect(0, 0, canvas.width, canvas.height);
   context.fillStyle = 'brown';
   context.beginPath();
   context.rect(canvas.width / 4 - 5, 250, 10, 150);
   context.fill();
   context.beginPath();
   context.rect(canvas.width / 2 - 5, 250, 10, 150);
   context.fill();
   context.beginPath();
   context.rect(3 * canvas.width / 4 - 5, 250, 10, 150);
   context.fill();
   for (var i = 0; i <= CURRENTDISCNUM - 1; i++) DISCLIST[i].draw();
   canvas.addEventListener('mousemove', highlightPeg, true);
}

//User sets the number of discs and resets after selection.
function setDiskNum(discNum) {
   CURRENTDISCNUM = discNum;
   baseDraw();
}

function drawIndicator(x, peg, color) {
   if (!color) color = 'purple';
   context.save();
   context.fillStyle = color;
   context.beginPath();
   context.moveTo(x - 20, 0);
   context.lineTo(x + 20, 0);
   context.lineTo(x, 20);
   context.fill();
   context.restore();
   CURRENTSTARTPEG = peg;
   canvas.addEventListener('mousedown', selectPeg, true);
}

function selectPeg() {
   context.clearRect(0, 0, canvas.width, 50);
   if (CURRENTSTARTPEG === 1) drawIndicator(canvas.width / 4, 1, 'green');
}

function highlightPeg(evt) {
   var loc = windowToCanvas_mouse(canvas, evt.clientX, evt.clientY);
   context.clearRect(0, 0, canvas.width, 50);
   if (loc.x <= canvas.width / 4 + 30 && loc.x >= canvas.width / 4 - 30 && loc.y > 250 && loc.y < 380) 
      drawIndicator(canvas.width / 4, 1);
   else if (loc.x <= canvas.width / 2 + 30 && loc.x >= canvas.width / 2 - 30 && loc.y > 250 && loc.y < 380) 
      drawIndicator(canvas.width / 2, 2);
   else if (loc.x <= 3 * canvas.width / 4 + 30 && loc.x >= 3 * canvas.width / 4 - 30 && loc.y > 250 && loc.y < 380)
      drawIndicator(3 * canvas.width / 4, 3);
   else canvas.removeEventListener('mousedown', selectPeg, true);
}

baseDraw();
</script>
